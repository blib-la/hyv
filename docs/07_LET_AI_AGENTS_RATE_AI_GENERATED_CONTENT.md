# Understanding the Hyv Jury System

The jury system in Hyv is designed to facilitate competitions or scenarios where multiple entries
are evaluated according to specific rules and rating criteria. In the example provided, a
competition for writing unique stories is setup, with each entry evaluated by multiple jurors. The
verdict is determined by the aggregation of the jurors' decisions.

## Setting up the System

Firstly, detailed instructions are created for both the competitors (authors) and the jurors:

```typescript
const authorInstruction = createInstruction(
    "Author, Competitor",
    minify`
	Do tasks. Respect rules and rating criteria.
	Think deeply, reason your thoughts, decide based on your reasoning.
	`,
    {
        thoughts: "deep thoughts",
        reason: "critical reasoning",
        decision: "detailed decision",
        story: {
            name: "name of story",
            content: "the story â€¦",
        },
    }
);

const juryInstruction = createInstruction(
    "Competition Jury",
    minify`
	Do tasks. Respect rules and rating criteria.
	Think deeply, reason your thoughts, decide based on your reasoning.
	`,
    {
        thoughts: "deep thoughts",
        reason: "critical reasoning",
        decision: "detailed decision",
        winner: "name of story",
    }
);
```

The `createInstruction` function constructs a clear directive for each role, specifying the
expectations for each task.

## Creating Entries

Next, multiple entries are created using the `createAndAssign` function. Each entry is generated by
an author AI agent that follows the `authorInstruction` to write a unique story for the competition:

```typescript
const stories = (await Promise.all(
    Array.from(
        { length: 3 },
        async () =>
            (
                await createAndAssign(
                    { task: "Write a UNIQUE story for a competition", rules, ratingCriteria },
                    authorInstruction,
                    {
                        async after(
                            message: ModelMessage & { story: { name: string; content: string } }
                        ): Promise<
                            ModelMessage & {
                                story: { name: string; content: string; wordCount: number };
                            }
                        > {
                            return {
                                ...message,
                                story: {
                                    ...message.story,
                                    wordCount: getWordCount(message.story.content),
                                },
                            };
                        },
                    }
                )
            ).message.story
    )
)) as FileContentWithPath[];
```

## Judging Entries

Then, multiple AI agents, acting as jurors, review the entries. Each juror is assigned the
`juryInstruction` to read the stories and choose a winner:

```typescript
const votes = (await Promise.all(
    Array.from(
        { length: 3 },
        async () =>
            (
                await createAndAssign(
                    {
                        task: "Read the stories and pick a winner",
                        rules,
                        ratingCriteria,
                        stories,
                    },
                    juryInstruction
                )
            ).message.winner
    )
)) as FileContentWithPath[];
```

## Final Decision

Finally, a separate agent, `finalJury`, counts the votes from all the jurors and declares the
winner:

```typescript
await finalJury.assign({
    task: "Count the votes and determine the winner",
    votes,
});
```

With these steps, Hyv facilitates a full competition system where entries are created, evaluated by
multiple jurors, and a final winner is decided based on the collective decision. Each AI agent
performs its role following the defined instructions, ensuring a fair and systematic evaluation
process.
